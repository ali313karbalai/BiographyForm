<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=800, initial-scale=0.4, maximum-scale=2.0, user-scalable=yes">
  <title>Ø¨Ø±Ú¯Ù‡ Ø¨ÛŒÙˆÚ¯Ø±Ø§ÙÛŒ</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    /* --- Ø§Ø³ØªØ§ÛŒÙ„ Ø¬Ø¯ÛŒØ¯ Ùˆ Ø¬Ø°Ø§Ø¨ Ú©Ø§Ø¯Ø± Ø±Ø§Ù‡Ù†Ù…Ø§ --- */
    #guide-modal {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(44, 62, 80, 0.8);
      display: flex; justify-content: center; align-items: center;
      z-index: 1000;
      backdrop-filter: blur(5px);
    }
    .modal-content {
      background: #fff;
      padding: 30px;
      border-radius: 20px;
      width: 550px;
      max-width: 90%;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      text-align: right;
      line-height: 1.8;
      border: 1px solid #eee;
    }
    .modal-content h3 { 
      color: #2c3e50; 
      margin-top: 0; 
      text-align: center;
      font-size: 22px;
      border-bottom: 2px solid #3498db;
      padding-bottom: 15px;
      margin-bottom: 20px;
    }
    .guide-item {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      margin-bottom: 18px;
    }
    .guide-icon {
      font-size: 24px;
      background: #f0f3f5;
      padding: 5px;
      border-radius: 10px;
      min-width: 40px;
      text-align: center;
    }
    .guide-text b { color: #2980b9; display: block; font-size: 16px; }
    .guide-text p { margin: 0; color: #555; font-size: 14px; }

    .btn-close-modal {
      background: #3498db; color: #fff; border: none; padding: 12px;
      border-radius: 12px; cursor: pointer; font-family: Tahoma; font-weight: bold;
      width: 100%; margin-top: 10px; font-size: 16px;
      transition: background 0.3s;
    }
    .btn-close-modal:hover { background: #2980b9; }

    /* --- Ø§Ø³ØªØ§ÛŒÙ„ Ø¨Ø¯Ù†Ù‡ Ùˆ Ø¬Ø¯ÙˆÙ„ --- */
    body {
      font-family: Tahoma, Arial, sans-serif;
      background: #f4f7f6;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px 0; margin: 0;
    }
    #capture-area {
      background: #fff; width: 800px; padding: 20px;
      border: 2px solid #000; box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      box-sizing: border-box;
    }
    table { width: 100%; border-collapse: collapse; border: 2px solid #000; }
    td { 
      border: 1px solid #000; padding: 8px; vertical-align: middle; 
      font-size: 14px; line-height: 1.8; text-align: right; white-space: nowrap; 
    }
    .header-cell { text-align: center; font-weight: bold; font-size: 20px; padding: 15px; white-space: normal; }
    input[type="text"], textarea {
      border: none; outline: none; background: transparent;
      color: red; font-size: 15px; font-weight: bold; font-family: Tahoma, sans-serif;
      text-align: right; direction: rtl; width: auto; flex-grow: 1;
      line-height: 1.8; padding-bottom: 2px;
    }
    textarea { width: 100%; resize: none; overflow: hidden; display: block; white-space: normal; }
    .answer-select {
      border: none; outline: none; background: transparent;
      color: red; font-size: 15px; font-weight: bold; font-family: Tahoma, sans-serif;
      text-align: right; direction: rtl; width: auto; flex-grow: 1;
      appearance: none;
      background-image: url('data:image/svg+xml;utf8,<svg fill="%23ff0000" height="14" viewBox="0 0 24 24" width="14" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>');
      background-repeat: no-repeat; background-position: left center;
      padding-left: 20px; line-height: 1.8; cursor: pointer;
    }
    .flex-row { display: flex; align-items: center; gap: 5px; justify-content: flex-start; direction: rtl; }
    .checkbox-group { display: inline-flex; align-items: center; gap: 4px; margin-left: 10px; cursor: pointer; }
    .checkbox-group:has(input:checked) { color: red; font-weight: bold; }

    /* Ù†ÙˆØ§Ø± Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ */
    .controls-container {
      margin-top: 30px; display: flex; justify-content: space-between;
      width: 800px; box-sizing: border-box; background: #fff;
      padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      margin-bottom: 50px;
    }
    .button-group { display: flex; gap: 12px; }
    button {
      padding: 12px 18px; cursor: pointer; border: none; border-radius: 8px;
      font-family: Tahoma; font-weight: bold; font-size: 14px;
      transition: all 0.2s; display: flex; align-items: center; gap: 8px;
    }
    .btn-backup { background: #607d8b; color: #fff; }
    .btn-restore { background: #90a4ae; color: #fff; }
    .btn-share { background: #0088cc; color: #fff; }
    .btn-download { background: #2ecc71; color: #fff; }
    button:active { transform: scale(0.95); }
    #fileInput { display: none; }
    .footer-row td { font-weight: bold; font-size: 19px; padding: 16px; white-space: normal; }
    #instagram { direction: ltr !important; text-align: left !important; unicode-bidi: plaintext !important; }
  </style>
</head>
<body>

  <div id="guide-modal">
    <div class="modal-content">
      <h3>ğŸ‘‹ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯! Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ú©ÙˆØªØ§Ù‡:</h3>
      
      <div class="guide-item">
        <div class="guide-icon">âœï¸</div>
        <div class="guide-text">
          <b>Ù†Ø­ÙˆÙ‡ ØªÚ©Ù…ÛŒÙ„ ÙØ±Ù…</b>
          <p>Ø®ÛŒÙ„ÛŒ Ø³Ø§Ø¯Ù‡ Ø§Ø³Øª! Ø¨Ø§ Ú©Ù„ÛŒÚ© Ú©Ø±Ø¯Ù† Ø¬Ù„ÙˆÛŒ Ø³ÙˆØ§Ù„Ø§ØªØŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù¾Ø§Ø³Ø® Ø®ÙˆØ¯ Ø±Ø§ ØªØ§ÛŒÙ¾ Ú©Ù†ÛŒØ¯.</p>
        </div>
      </div>

      <div class="guide-item">
        <div class="guide-icon">ğŸŒ</div>
        <div class="guide-text">
          <b>Ø§Ø² Ú¯ÙˆÚ¯Ù„ Ú©Ø±ÙˆÙ… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</b>
          <p>Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ†Ú©Ù‡ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ Ùˆ Ø°Ø®ÛŒØ±Ù‡ Ø¹Ú©Ø³ Ø¯Ø±Ø³Øª Ú©Ø§Ø± Ú©Ù†Ù†Ø¯ØŒ Ø­ØªÙ…Ø§Ù‹ Ù„ÛŒÙ†Ú© Ø±Ø§ Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø± Chrome Ø¨Ø§Ø² Ú©Ù†ÛŒØ¯.</p>
        </div>
      </div>

      <div class="guide-item">
        <div class="guide-icon">ğŸ“‚</div>
        <div class="guide-text">
          <b>Ø°Ø®ÛŒØ±Ù‡ Ùˆ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ (Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ù…Øª Ø±Ø§Ø³Øª)</b>
          <p>Ø§Ú¯Ø± ÙØ±Ù… Ø±Ø§ Ù†ÛŒÙ…Ù‡â€ŒÚ©Ø§Ø±Ù‡ Ù¾Ø± Ú©Ø±Ø¯ÛŒØ¯ØŒ Â«Ù¾Ø´ØªÛŒØ¨Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒÂ» Ø¨Ø²Ù†ÛŒØ¯. Ø¨Ø¹Ø¯Ø§Ù‹ Ø¨Ø§ Â«Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒÂ» Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø¯Ø§Ù…Ù‡ Ø¯Ù‡ÛŒØ¯.</p>
        </div>
      </div>

      <div class="guide-item">
        <div class="guide-icon">ğŸ–¼ï¸</div>
        <div class="guide-text">
          <b>Ø¯Ø±ÛŒØ§ÙØª Ø¹Ú©Ø³ Ù†Ù‡Ø§ÛŒÛŒ (Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ù…Øª Ú†Ù¾)</b>
          <p>Ø¨Ø¹Ø¯ Ø§Ø² ØªÚ©Ù…ÛŒÙ„ØŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¹Ú©Ø³ ÙØ±Ù… Ø±Ø§ Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ Â«ØªÙ„Ú¯Ø±Ø§Ù…Â» Ø¨ÙØ±Ø³ØªÛŒØ¯ ÛŒØ§ Ø¢Ù† Ø±Ø§ Â«Ø¯Ø§Ù†Ù„ÙˆØ¯Â» Ú©Ù†ÛŒØ¯.</p>
        </div>
      </div>

      <button class="btn-close-modal" onclick="closeModal()">Ù…ØªÙˆØ¬Ù‡ Ø´Ø¯Ù…ØŒ Ø¨Ø±ÛŒÙ… Ø³Ø±Ø§Øº ÙØ±Ù…!</button>
    </div>
  </div>

  <div id="capture-area">
    <table>
      <tr><td colspan="2" class="header-cell">Ø¨Ø±Ú¯Ù‡ Ø¨ÛŒÙˆÚ¯Ø±Ø§ÙÛŒ</td></tr>
      <tr>
        <td width="48%"><div class="flex-row">Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ Ù…Ø¹Ø±Ù: <input type="text" id="moaref_name"></div></td>
        <td width="52%"><div class="flex-row">Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ Ù¾Ø±Ø§Ø³Ù¾Ú©Øª: <input type="text" id="prospect_name"></div></td>
      </tr>
      <tr>
        <td><div class="flex-row">Ø³Ø§Ø¹Øª Ø¯Ù‚ÛŒÙ‚ Ùˆ ØªØ§Ø±ÛŒØ® Ù¾Ø±Ø²Ù†Øª: <input type="text" id="present_date"></div></td>
        <td><div class="flex-row">Ø³Ù† Ù¾Ø±Ø§Ø³Ù¾Ú©Øª: <input type="text" id="prospect_age"></div></td>
      </tr>
      <tr>
        <td><div class="flex-row">Ù…Ú©Ø§Ù† Ù¾Ø±Ø²Ù†Øª: <input type="text" id="present_location"></div></td>
        <td><div class="flex-row">Ù†Ø³Ø¨Øª Ø¨Ø§ Ù…Ø¹Ø±Ù: <input type="text" id="relation"></div></td>
      </tr>
      <tr>
        <td>
          <div class="flex-row">ØªØ­ØµÛŒÙ„Ø§Øª:
            <select id="education" class="answer-select" required>
              <option value="" disabled selected>Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
              <option value="Ø²ÛŒØ± Ø¯ÛŒÙ¾Ù„Ù…">Ø²ÛŒØ± Ø¯ÛŒÙ¾Ù„Ù…</option>
              <option value="Ø¯ÛŒÙ¾Ù„Ù…">Ø¯ÛŒÙ¾Ù„Ù…</option>
              <option value="Ù„ÛŒØ³Ø§Ù†Ø³">Ù„ÛŒØ³Ø§Ù†Ø³</option>
              <option value="ÙÙˆÙ‚ Ù„ÛŒØ³Ø§Ù†Ø³">ÙÙˆÙ‚ Ù„ÛŒØ³Ø§Ù†Ø³</option>
              <option value="Ø¯Ú©ØªØ±ÛŒ">Ø¯Ú©ØªØ±ÛŒ</option>
              <option value="Ù†Ù…ÛŒâ€ŒØ¯Ø§Ù†Ù…">Ù†Ù…ÛŒâ€ŒØ¯Ø§Ù†Ù…</option>
            </select>
          </div>
        </td>
        <td><div class="flex-row">Ø±Ø´ØªÙ‡ ØªØ­ØµÛŒÙ„ÛŒ: <input type="text" id="major"></div></td>
      </tr>
      <tr>
        <td>
          <div class="flex-row">ÙˆØ¶Ø¹ÛŒØª ØªØ£Ù‡Ù„: 
            <select id="marriage" class="answer-select" required>
              <option value="" disabled selected>Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
              <option value="Ù…Ø¬Ø±Ø¯">Ù…Ø¬Ø±Ø¯</option><option value="Ù…ØªØ£Ù‡Ù„">Ù…ØªØ£Ù‡Ù„</option>
              <option value="Ø·Ù„Ø§Ù‚ Ú¯Ø±ÙØªÙ‡">Ø·Ù„Ø§Ù‚ Ú¯Ø±ÙØªÙ‡</option><option value="Ù‡Ù…Ø³Ø± ÙÙˆØª Ú©Ø±Ø¯Ù‡">Ù‡Ù…Ø³Ø± ÙÙˆØª Ú©Ø±Ø¯Ù‡</option>
              <option value="Ù†Ù…ÛŒâ€ŒØ¯Ø§Ù†Ù…">Ù†Ù…ÛŒâ€ŒØ¯Ø§Ù†Ù…</option>
            </select>
          </div>
        </td>
        <td>
          <div class="flex-row">ØªØ¹Ø¯Ø§Ø¯ ÙØ±Ø²Ù†Ø¯:
            <select id="children" class="answer-select" required>
              <option value="" disabled selected>Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
              <option value="ØµÙØ±">ØµÙØ±</option><option value="Û±">Û±</option><option value="Û²">Û²</option>
              <option value="Û³">Û³</option><option value="Û´">Û´</option>
              <option value=" Ø¨ÛŒØ´ØªØ± Ø§Ø² Û´">Ø¨ÛŒØ´ØªØ± Ø§Ø² Û´</option><option value="Ù†Ù…ÛŒâ€ŒØ¯Ø§Ù†Ù…">Ù†Ù…ÛŒâ€ŒØ¯Ø§Ù†Ù…</option>
            </select>
          </div>
        </td>
      </tr>
      <tr><td colspan="2" style="white-space: normal;"><div class="flex-row">Ø´ØºÙ„ ÙØ¹Ù„ÛŒ Ùˆ Ø³Ø§Ø¨Ù‚Ù‡ Ù…Ø´Ø§ØºÙ„ Ù‚Ø¨Ù„ÛŒ: <input type="text" id="job_history"></div></td></tr>
      <tr><td colspan="2" style="white-space: normal;"><div class="flex-row">Ù…ÛŒØ²Ø§Ù† Ø¯Ø±Ø¢Ù…Ø¯: <input type="text" id="income"></div></td></tr>
      <tr class="merge-top">
        <td colspan="2" style="white-space: normal;"><div class="flex-row">Ø¯ØºØ¯ØºÙ‡ ÙØ¹Ù„ÛŒ:
            <label class="checkbox-group">Ø¯Ø±Ø¢Ù…Ø¯<input type="checkbox" id="d_daramad"></label>
            <label class="checkbox-group">Ø²Ù…Ø§Ù†<input type="checkbox" id="d_zaman"></label>
            <label class="checkbox-group">Ù¾ÛŒØ´Ø±ÙØª<input type="checkbox" id="d_pishraft"></label>
            <label class="checkbox-group">Ø§Ù…Ù†ÛŒØª Ø´ØºÙ„ÛŒ<input type="checkbox" id="d_amniat"></label>
        </div></td>
      </tr>
      <tr class="merge-bottom"><td colspan="2" style="white-space: normal;"><div class="flex-row">ØªÙˆØ¶ÛŒØ­Ø§Øª Ø¨ÛŒØ´ØªØ±: <input type="text" id="desc1"></div></td></tr>
      <tr class="merge-top">
        <td colspan="2" style="white-space: normal;"><div class="flex-row" style="flex-wrap:wrap;">ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø´Ø®ØµÛŒØªÛŒ:
            <label class="checkbox-group">Ø§Ø¬ØªÙ…Ø§Ø¹ÛŒ<input type="checkbox" id="v_ejtemai"></label>
            <label class="checkbox-group">Ø±ÛŒØ³Ú©â€ŒÙ¾Ø°ÛŒØ±<input type="checkbox" id="v_risk"></label>
            <label class="checkbox-group">Ù…Ø³ØªÙ‚Ù„<input type="checkbox" id="v_mostaghel"></label>
            <label class="checkbox-group">Ù…Ø°Ù‡Ø¨ÛŒ<input type="checkbox" id="v_mazhabi"></label>
            <label class="checkbox-group">Ø±ÙÚ©<input type="checkbox" id="v_rok"></label>
            <label class="checkbox-group">Ø´Ú©Ø§Ú©<input type="checkbox" id="v_shakak"></label>
            <label class="checkbox-group">Ø±ÙÛŒÙ‚â€ŒØ¨Ø§Ø²<input type="checkbox" id="v_rafigh"></label>
        </div></td>
      </tr>
      <tr class="merge-bottom">
        <td colspan="2" style="white-space: normal;"><div class="flex-row">
            <label class="checkbox-group">Ø®ÙˆØ§Ø³ØªØ§Ø± ØªØ¬Ø±Ø¨Ù‡â€ŒÙ‡Ø§ÛŒ ØªØ§Ø²Ù‡<input type="checkbox" id="exp_new"></label>
            <label class="checkbox-group">Ø§Ù‡Ù…ÛŒØªâ€ŒØ¯Ù‡Ù†Ø¯Ù‡ Ø¨Ù‡ Ø­Ø±Ù Ø§Ø·Ø±Ø§ÙÛŒØ§Ù†<input type="checkbox" id="atrafian"></label>
            ØªÙˆØ¶ÛŒØ­Ø§Øª Ø¨ÛŒØ´ØªØ±: <input type="text" id="desc2">
        </div></td>
      </tr>
      <tr><td colspan="2" style="white-space: normal;"><div class="flex-row">Ø³Ø±Ú¯Ø±Ù…ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ø¹Ù„Ø§Ù‚Ù‡: <input type="text" id="hobbies"></div></td></tr>
      <tr><td colspan="2" style="white-space: normal;"><div class="flex-row">Ù…ÛŒØ²Ø§Ù† Ø¢Ø´Ù†Ø§ÛŒÛŒ Ø¨Ø§ Ø¹Ù„Ù… Ø±ÙˆØ² Ùˆ Ø¨Ø§Ø²Ø§Ø±ÛŒØ§Ø¨ÛŒ Ø´Ø¨Ú©Ù‡â€ŒØ§ÛŒ: <input type="text" id="mlm_knowledge"></div></td></tr>
      <tr><td colspan="2" style="white-space: normal;"><div class="flex-row">ØªØ§Ø±ÛŒØ® Ø¢Ø®Ø±ÛŒÙ† Ø¯ÛŒØ¯Ø§Ø± Ùˆ Ø¹Ù„Øª Ø¯ÛŒØ¯Ø§Ø±: <input type="text" id="last_visit"></div></td></tr>
      <tr><td colspan="2" style="white-space: normal;"><div class="flex-row">Ø¢Ø®Ø±ÛŒÙ† Ø®Ø§Ø·Ø±Ù‡ Ù…Ø´ØªØ±Ú©: <input type="text" id="memory"></div></td></tr>
      <tr><td colspan="2" style="white-space: normal;"><div class="flex-row">Ù†ÛŒØ§Ø²Ù‡Ø§ÛŒ Ø§Ù…Ø±ÙˆØ²Ù‡ Ùˆ Ø¨Ø²Ø±Ú¯ØªØ±ÛŒÙ† Ø§Ù‡Ø¯Ø§Ù: <input type="text" id="goals"></div></td></tr>
      <tr><td colspan="2" style="white-space: normal;"><div class="flex-row">Ú†Ø§Ù„Ø´â€ŒÙ‡Ø§ÛŒ Ø²Ù†Ø¯Ú¯ÛŒ: <input type="text" id="challenges"></div></td></tr>
      <tr><td colspan="2" style="white-space: normal;"><div class="flex-row">Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡ Ø¯Ø± Ø²Ù†Ú¯ Ø¯Ø¹ÙˆØª (Ø¯ÛŒØ¯ Ú©Ø§Ø±ÛŒ): <input type="text" id="invite_info"></div></td></tr>
      <tr><td colspan="2" style="white-space: normal;"><div class="flex-row">Ø¢Ø¯Ø±Ø³ Ø§ÛŒÙ†Ø³ØªØ§Ú¯Ø±Ø§Ù…: <input type="text" id="instagram"></div></td></tr>
      <tr><td colspan="2" style="height:100px; vertical-align:top; white-space: normal;">ØªÙˆØ¶ÛŒØ­Ø§Øª Ø¨Ø§Ù‚ÛŒÙ…Ø§Ù†Ø¯Ù‡: <textarea id="final_desc" rows="4"></textarea></td></tr>

      <tr class="footer-row">
        <td colspan="2">
          Ø§ÛŒÙ†Ø¬Ø§Ù†Ø¨ ( <input type="text" id="footer_me" style="width:120px; text-align:center;"> ) Ø¯Ø±Ø®ÙˆØ§Ø³Øª ØªØ£ÛŒÛŒØ¯ÛŒÙ‡ Ø¬Ù‡Øª Ø²Ù†Ú¯ Ø¯Ø¹ÙˆØª Ø¨Ù‡ Ø§ÛŒØ´Ø§Ù† Ùˆ Ù…Ø´Ø®Øµ Ú©Ø±Ø¯Ù† Ù¾Ø±Ø²Ù†ØªÙˆØ± Ø§Ø² Ø¢Ù‚Ø§ / Ø®Ø§Ù†Ù… ( <input type="text" id="footer_target" style="width:120px; text-align:center;"> ) (Ø§ÙˆÙ„ÛŒÙ† ÙØ§Ù„ÙˆØ¦Ø±) Ø±Ø§ Ø¯Ø§Ø±Ù….
        </td>
      </tr>
    </table>
  </div>

  <div class="controls-container">
    <div class="button-group">
      <button class="btn-backup" onclick="saveBackup()">ğŸ’¾ Ù¾Ø´ØªÛŒØ¨Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ</button>
      <button class="btn-restore" onclick="document.getElementById('fileInput').click()">ğŸ“‚ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ</button>
    </div>
    <div class="button-group">
      <button class="btn-share" onclick="shareImage()">âœˆï¸ Ø§Ø±Ø³Ø§Ù„ Ø¯Ø± ØªÙ„Ú¯Ø±Ø§Ù…</button>
      <button class="btn-download" onclick="downloadJPG()">ğŸ–¼ï¸ Ø¯Ø§Ù†Ù„ÙˆØ¯ ØªØµÙˆÛŒØ±</button>
    </div>
    <input type="file" id="fileInput" accept=".json" onchange="restoreBackup(event)">
  </div>

  <script>
    function closeModal() { document.getElementById('guide-modal').style.display = 'none'; }

    async function prepareForCapture() {
      const el = document.getElementById('capture-area');
      const instaField = document.getElementById('instagram');
      const finalDesc = document.getElementById('final_desc');
      const originalInsta = instaField.value;
      const originalDesc = finalDesc.value;

      if(originalInsta && !originalInsta.startsWith('\u200E')){
          instaField.value = '\u200E' + originalInsta;
      }

      const descReplacement = document.createElement('div');
      descReplacement.innerText = originalDesc;
      descReplacement.style.cssText = "white-space:pre-wrap; color:red; font-size:15px; font-weight:bold; font-family:Tahoma; text-align:right; line-height:1.8; padding-top:2px;";
      
      finalDesc.style.display = 'none';
      finalDesc.parentNode.appendChild(descReplacement);

      const canvas = await html2canvas(el, { scale: 3, backgroundColor: '#ffffff', useCORS: true });
      
      instaField.value = originalInsta;
      finalDesc.style.display = 'block';
      descReplacement.remove();
      return canvas;
    }

    async function downloadJPG(){
      const prospectName = document.getElementById('prospect_name').value.trim();
      const canvas = await prepareForCapture();
      const a = document.createElement('a');
      a.download = prospectName ? `Ø¨ÛŒÙˆÚ¯Ø±Ø§ÙÛŒ ${prospectName}.jpg` : 'biography-sheet.jpg';
      a.href = canvas.toDataURL('image/jpeg', 0.98);
      a.click();
    }

    async function shareImage() {
      try {
        const prospectName = document.getElementById('prospect_name').value.trim();
        const canvas = await prepareForCapture();
        canvas.toBlob(async (blob) => {
          const file = new File([blob], 'biography.jpg', { type: 'image/jpeg' });
          if (navigator.canShare && navigator.canShare({ files: [file] })) {
            await navigator.share({ files: [file], title: 'Ø¨Ø±Ú¯Ù‡ Ø¨ÛŒÙˆÚ¯Ø±Ø§ÙÛŒ', text: `Ø¨ÛŒÙˆÚ¯Ø±Ø§ÙÛŒ ${prospectName}` });
          } else {
            alert("Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù…Ø³ØªÙ‚ÛŒÙ… Ø¯Ø± Ø§ÛŒÙ† Ù…Ø±ÙˆØ±Ú¯Ø± Ù…Ù‚Ø¯ÙˆØ± Ù†ÛŒØ³Øª. Ø§Ø² Ø¯Ú©Ù…Ù‡ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.");
          }
        }, 'image/jpeg', 0.95);
      } catch (err) { console.error(err); }
    }

    function saveBackup(){
      const data={};
      document.querySelectorAll('input, textarea, select').forEach(el=>{
        data[el.id] = (el.type==='checkbox') ? el.checked : el.value;
      });
      const prospectName = document.getElementById('prospect_name').value.trim();
      const backupFileName = prospectName ? `Ø¨ÛŒÙˆÚ¯Ø±Ø§ÙÛŒ ${prospectName}.json` : 'backup-biography.json';
      const blob=new Blob([JSON.stringify(data)],{type:'application/json'});
      const url=URL.createObjectURL(blob);
      const a=document.createElement('a');
      a.href=url; a.download = backupFileName; a.click();
    }

    function restoreBackup(e){
      const file=e.target.files[0]; if(!file) return;
      const reader=new FileReader();
      reader.onload=(ev)=>{
        const data=JSON.parse(ev.target.result);
        for(const id in data){
          const el=document.getElementById(id);
          if(el) {
            if(el.type==='checkbox') el.checked=!!data[id];
            else el.value=data[id];
          }
        }
      };
      reader.readAsText(file);
    }

    document.querySelectorAll('textarea').forEach(t=>{
      const fit=()=>{ t.style.height='auto'; t.style.height=t.scrollHeight+'px'; };
      t.addEventListener('input',fit); fit();
    });
  </script>
</body>
</html>
